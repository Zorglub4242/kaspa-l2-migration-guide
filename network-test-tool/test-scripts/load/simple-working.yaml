# Simple Load Test (Working Version)
test: Simple Load Test
description: Generate transaction load with basic features

variables:
  users: 5
  transactions_per_user: 10

setup:
  accounts:
    funder:
      privateKey: env:PRIVATE_KEY
    user0: 0.1 ETH
    user1: 0.1 ETH
    user2: 0.1 ETH
    user3: 0.1 ETH
    user4: 0.1 ETH

scenario:
  - log: "Starting load test with 5 users"

  # Fund users
  - transfer: funder -> user0, 2 ETH
  - transfer: funder -> user1, 2 ETH
  - transfer: funder -> user2, 2 ETH
  - transfer: funder -> user3, 2 ETH
  - transfer: funder -> user4, 2 ETH

  # Warm-up phase
  - log: "Starting warm-up phase"
  - transfer: user0 -> user1, 0.001 ETH
  - wait: 500ms
  - transfer: user1 -> user0, 0.001 ETH
  - wait: 500ms

  # Generate load - Batch 1
  - log: "Batch 1 - Generating load"
  - transfer: user0 -> user1, 0.001 ETH
  - transfer: user1 -> user2, 0.001 ETH
  - transfer: user2 -> user3, 0.001 ETH
  - transfer: user3 -> user4, 0.001 ETH
  - transfer: user4 -> user0, 0.001 ETH
  - wait: 1s

  # Generate load - Batch 2
  - log: "Batch 2 - Generating load"
  - transfer: user0 -> user2, 0.001 ETH
  - transfer: user1 -> user3, 0.001 ETH
  - transfer: user2 -> user4, 0.001 ETH
  - transfer: user3 -> user0, 0.001 ETH
  - transfer: user4 -> user1, 0.001 ETH
  - wait: 1s

  # Generate load - Batch 3
  - log: "Batch 3 - Generating load"
  - transfer: user0 -> user3, 0.001 ETH
  - transfer: user1 -> user4, 0.001 ETH
  - transfer: user2 -> user0, 0.001 ETH
  - transfer: user3 -> user1, 0.001 ETH
  - transfer: user4 -> user2, 0.001 ETH
  - wait: 1s

  # Generate load - Batch 4
  - log: "Batch 4 - Generating load"
  - transfer: user0 -> user4, 0.001 ETH
  - transfer: user1 -> user0, 0.001 ETH
  - transfer: user2 -> user1, 0.001 ETH
  - transfer: user3 -> user2, 0.001 ETH
  - transfer: user4 -> user3, 0.001 ETH
  - wait: 1s

  # Generate load - Batch 5
  - log: "Batch 5 - Generating load"
  - transfer: user0 -> user1, 0.001 ETH
  - transfer: user1 -> user2, 0.001 ETH
  - transfer: user2 -> user3, 0.001 ETH
  - transfer: user3 -> user4, 0.001 ETH
  - transfer: user4 -> user0, 0.001 ETH

  # Final burst
  - log: "Final burst"
  - parallel:
    - transfer: user0 -> user1, 0.001 ETH
    - transfer: user1 -> user2, 0.001 ETH
    - transfer: user2 -> user3, 0.001 ETH
    - transfer: user3 -> user4, 0.001 ETH
    - transfer: user4 -> user0, 0.001 ETH

  # Report results
  - log: "Load test complete"
  - log: "Total transactions: 50"

cleanup:
  # Return funds to funder
  - transfer: user0 -> funder, 0.5 ETH
  - transfer: user1 -> funder, 0.5 ETH
  - transfer: user2 -> funder, 0.5 ETH
  - transfer: user3 -> funder, 0.5 ETH
  - transfer: user4 -> funder, 0.5 ETH